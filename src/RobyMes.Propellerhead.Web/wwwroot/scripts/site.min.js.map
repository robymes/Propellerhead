{"version":3,"sources":["Utils.js","ApiService.js","ApplicationBus.js","CustomerListViewModel.js","NewCustomerViewModel.js","CustomerViewModel.js","IndexApp.js","CustomerApp.js"],"names":["this","ptt","ajax","type","url","data","contentType","cors","headers","options","cache","crossDomain","JSON","stringify","jQuery","postJson","getJson","ctor","self","route","location","host","getCustomersServiceUrl","getCustomersOrderByNameServiceUrl","getCustomersOrderByCreationDateServiceUrl","getCustomerByIdServiceUrl","newCustomerServiceUrl","updateCustomerStatusServiceUrl","getCustomers","pageSize","pageIndex","request","PageSize","PageIndex","NameFilter","CreatioDateFilter","CustomerStatusFilter","getCustomersOrderByName","ascending","Query","Ascending","getCustomersOrderByCreationDate","getCustomerById","id","newCustomer","name","updateCustomerStatus","status","ApiService","newCustomerAdded","Bacon","Bus","ApplicationBus","apiService","applicationBus","loadItems","loadItemsOrderedByName","loadItemsOrderedByCreationDate","noOrdering","ascOrdering","items","ko","observableArray","errorMessage","observable","nameOrdering","creationdateOrdering","orderByName","orderByCreationDate","pageindex","done","removeAll","fail","error","onValue","onError","message","init","CustomerListViewModel","canInsertNewItem","computed","insertNewItem","result","push","Error","NewCustomerViewModel","customerId","loadItem","itemLoaded","creationDate","statusList","subscribe","newStatus","item","CustomerViewModel","viewModel","customerList","applyBindings","IndexApp","customer","CustomerApp"],"mappings":"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","file":"site.min.js","sourcesContent":["this.ptt = (function (ptt) {\r\n    ptt.ajax = function (type, url, data, contentType, cors, headers) {\r\n        var options = {\r\n            url: url,\r\n            contentType: contentType || \"application/json\",\r\n            cache: false,\r\n            type: type,\r\n            crossDomain: cors,\r\n            data: data ? JSON.stringify(data) : null\r\n        };\r\n        if (headers) {\r\n            options.headers = headers;\r\n        }\r\n        return jQuery.ajax(options);\r\n    };\r\n    ptt.postJson = function (url, data, cors) {\r\n        return ptt.ajax(\"POST\", url, data, null, cors, null);\r\n    };\r\n    ptt.getJson = function (url, cors) {\r\n        return ptt.ajax(\"GET\", url, null, null, cors, null);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function () {\r\n        var self = this,\r\n            route = \"http://\" + location.host + \"/api/\",\r\n            getCustomersServiceUrl = route + \"GetCustomers\",\r\n            getCustomersOrderByNameServiceUrl = route + \"GetCustomersOrderByName\",\r\n            getCustomersOrderByCreationDateServiceUrl = route + \"GetCustomersOrderByCreationDate\",\r\n            getCustomerByIdServiceUrl = route + \"GetCustomerById\",\r\n            newCustomerServiceUrl = route + \"NewCustomer\",\r\n            updateCustomerStatusServiceUrl = route + \"UpdateCustomerStatus\";\r\n\r\n        self.getCustomers = function (pageSize, pageIndex) {\r\n            var request = {\r\n                PageSize: pageSize,\r\n                PageIndex: pageIndex,\r\n                NameFilter: null,\r\n                CreatioDateFilter: null,\r\n                CustomerStatusFilter: null\r\n            };\r\n            return ptt.postJson(getCustomersServiceUrl, request, false);\r\n        };\r\n\r\n        self.getCustomersOrderByName = function (pageSize, pageIndex, ascending) {\r\n            var request = {\r\n                Query: {\r\n                    PageSize: pageSize,\r\n                    PageIndex: pageIndex,\r\n                    NameFilter: null,\r\n                    CreatioDateFilter: null,\r\n                    CustomerStatusFilter: null\r\n                },\r\n                Ascending: ascending\r\n            };\r\n            return ptt.postJson(getCustomersOrderByNameServiceUrl, request, false);\r\n        };\r\n\r\n        self.getCustomersOrderByCreationDate = function (pageSize, pageIndex, ascending) {\r\n            var request = {\r\n                Query: {\r\n                    PageSize: pageSize,\r\n                    PageIndex: pageIndex,\r\n                    NameFilter: null,\r\n                    CreatioDateFilter: null,\r\n                    CustomerStatusFilter: null\r\n                },\r\n                Ascending: ascending\r\n            };\r\n            return ptt.postJson(getCustomersOrderByCreationDateServiceUrl, request, false);\r\n        };\r\n\r\n        self.getCustomerById = function (id) {\r\n            var request = {\r\n                id: id\r\n            };\r\n            return ptt.postJson(getCustomerByIdServiceUrl, request, false);\r\n        };\r\n\r\n        self.newCustomer = function (name) {\r\n            var request = {\r\n                name: name\r\n            };\r\n            return ptt.postJson(newCustomerServiceUrl, request, false);\r\n        };\r\n\r\n        self.updateCustomerStatus = function (id, status) {\r\n            var request = {\r\n                id: id,\r\n                status: status\r\n            };\r\n            return ptt.postJson(updateCustomerStatusServiceUrl, request, false);\r\n        };\r\n    };\r\n    ptt.ApiService = function () {\r\n        return new ctor();\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function () {\r\n        var self = this;\r\n\r\n        self.newCustomerAdded = new Bacon.Bus();\r\n    };\r\n    ptt.ApplicationBus = function () {\r\n        return new ctor();\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (apiService, applicationBus) {\r\n        var self = this,\r\n            noOrdering = \"glyphicon-minus\",\r\n            ascOrdering = \"glyphicon-chevron-up\",\r\n            descOrdering = \"glyphicon-chevron-down\",\r\n            loadItems,\r\n            loadItemsOrderedByName,\r\n            loadItemsOrderedByCreationDate;\r\n\r\n        self.items = ko.observableArray([]);\r\n        self.errorMessage = ko.observable(\"\");\r\n        self.nameOrdering = ko.observable(noOrdering);\r\n        self.creationdateOrdering = ko.observable(noOrdering);\r\n\r\n        self.orderByName = function () {\r\n            self.creationdateOrdering(noOrdering);\r\n            if (self.nameOrdering() == ascOrdering) {\r\n                self.nameOrdering(descOrdering);\r\n                loadItemsOrderedByName(10, 0, false);\r\n            } else {\r\n                self.nameOrdering(ascOrdering);\r\n                loadItemsOrderedByName(10, 0, true);\r\n            }\r\n        };\r\n\r\n        self.orderByCreationDate = function () {\r\n            self.nameOrdering(noOrdering);\r\n            if (self.creationdateOrdering() == ascOrdering) {\r\n                self.creationdateOrdering(descOrdering);\r\n                loadItemsOrderedByCreationDate(10, 0, false);\r\n            } else {\r\n                self.creationdateOrdering(ascOrdering);\r\n                loadItemsOrderedByCreationDate(10, 0, true);\r\n            }\r\n        };\r\n\r\n        loadItems = function (pageSize, pageindex) {\r\n            self.nameOrdering(noOrdering);\r\n            self.creationdateOrdering(noOrdering);\r\n            apiService.getCustomers(pageSize, pageindex)\r\n                .done(function (items) {\r\n                    self.items.removeAll();\r\n                    self.items(items);\r\n                })\r\n                .fail(function (error) {\r\n                    self.errorMessage(\"An error has occurred loading customers\");\r\n                });\r\n        };\r\n\r\n        loadItemsOrderedByName = function (pageSize, pageindex, ascending) {\r\n            apiService.getCustomersOrderByName(pageSize, pageindex, ascending)\r\n                .done(function (items) {\r\n                    self.items.removeAll();\r\n                    self.items(items);\r\n                })\r\n                .fail(function (error) {\r\n                    self.errorMessage(\"An error has occurred loading customers\");\r\n                });\r\n        };\r\n\r\n        loadItemsOrderedByCreationDate = function (pageSize, pageindex, ascending) {\r\n            apiService.getCustomersOrderByCreationDate(pageSize, pageindex, ascending)\r\n                .done(function (items) {\r\n                    self.items.removeAll();\r\n                    self.items(items);\r\n                })\r\n                .fail(function (error) {\r\n                    self.errorMessage(\"An error has occurred loading customers\");\r\n                });\r\n        };\r\n\r\n        applicationBus.newCustomerAdded\r\n            .onValue(function () {\r\n                loadItems(10, 0);\r\n            });\r\n\r\n        applicationBus.newCustomerAdded\r\n            .onError(function (error) {\r\n                self.errorMessage(error.message);\r\n            });\r\n\r\n        self.init = function () {\r\n            self.errorMessage(\"\");\r\n            self.nameOrdering(noOrdering);\r\n            self.creationdateOrdering(noOrdering);\r\n            loadItems(10, 0);\r\n        };\r\n    };\r\n    ptt.CustomerListViewModel = function (apiService, applicationBus) {\r\n        return new ctor(apiService, applicationBus);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (apiService, applicationBus) {\r\n        var self = this;\r\n\r\n        self.name = ko.observable(\"\");\r\n\r\n        self.canInsertNewItem = ko.computed(function () {\r\n            return self.name() && true;\r\n        }, self);\r\n\r\n        self.insertNewItem = function () {\r\n            apiService.newCustomer(self.name())\r\n                .done(function (result) {\r\n                    self.name(\"\");\r\n                    applicationBus.newCustomerAdded.push(true);\r\n                })\r\n                .fail(function () {\r\n                    applicationBus.newCustomerAdded.error(new Bacon.Error(\"Error inserting a new Customer\"));\r\n                });\r\n        };\r\n    };\r\n    ptt.NewCustomerViewModel = function (apiService, applicationBus) {\r\n        return new ctor(apiService, applicationBus);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (apiService, applicationBus, customerId) {\r\n        var self = this,\r\n            loadItem,\r\n            itemLoaded = false;\r\n\r\n        self.name = ko.observable(\"\");\r\n        self.errorMessage = ko.observable(\"\");\r\n        self.creationDate = ko.observable(\"\");\r\n        self.status = ko.observable(\"\");\r\n        self.statusList = ko.observableArray([\r\n            \"Prospective\",\r\n            \"Current\",\r\n            \"NonActive\"\r\n        ]);\r\n\r\n        self.status.subscribe(function (newStatus) {\r\n            if (itemLoaded == true) {\r\n                apiService.updateCustomerStatus(customerId, newStatus)\r\n                    .done(function () {\r\n                        self.errorMessage(\"\");\r\n                    })\r\n                    .fail(function (error) {\r\n                        self.errorMessage(\"An error has occurred updating status\");\r\n                    });\r\n            } else {\r\n                itemLoaded = true;\r\n            }\r\n        });\r\n\r\n        loadItem = function (customerId) {\r\n            apiService.getCustomerById(customerId)\r\n                .done(function (item) {\r\n                    self.errorMessage(\"\");\r\n                    self.name(item.name);\r\n                    self.creationDate(item.creationDate);\r\n                    self.status(item.status);\r\n                })\r\n                .fail(function (error) {\r\n                    self.errorMessage(\"An error has occurred loading customer\");\r\n                });\r\n        };\r\n\r\n        self.init = function () {\r\n            loadItem(customerId);\r\n        };\r\n    };\r\n    ptt.CustomerViewModel = function (apiService, applicationBus, customerId) {\r\n        return new ctor(apiService, applicationBus, customerId);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function () {\r\n        var apiService = ptt.ApiService(),\r\n            applicationBus = ptt.ApplicationBus(),\r\n            viewModel = {\r\n                customerList: ptt.CustomerListViewModel(apiService, applicationBus),\r\n                newCustomer: ptt.NewCustomerViewModel(apiService, applicationBus)\r\n            };\r\n        ko.applyBindings(viewModel);\r\n        viewModel.customerList.init();\r\n    };\r\n    ptt.IndexApp = function () {\r\n        return new ctor();\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (customerId) {\r\n        var apiService = ptt.ApiService(),\r\n            applicationBus = ptt.ApplicationBus(),\r\n            viewModel = {\r\n                customer: ptt.CustomerViewModel(apiService, applicationBus, customerId)\r\n            };\r\n        ko.applyBindings(viewModel);\r\n        viewModel.customer.init();\r\n    };\r\n    ptt.CustomerApp = function (customerId) {\r\n        return new ctor(customerId);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));"]}