{"version":3,"sources":["Utils.js","ApiService.js","ApplicationBus.js","CustomerListViewModel.js","NewCustomerViewModel.js","CustomerViewModel.js","NewNoteViewModel.js","IndexApp.js","CustomerApp.js"],"names":["this","ptt","ajax","type","url","data","contentType","cors","headers","options","cache","crossDomain","JSON","stringify","jQuery","postJson","getJson","ctor","self","route","location","host","getCustomersServiceUrl","getCustomersOrderByNameServiceUrl","getCustomersOrderByCreationDateServiceUrl","getCustomerByIdServiceUrl","newCustomerServiceUrl","updateCustomerStatusServiceUrl","addCustomerNoteServiceUrl","getCustomers","pageSize","pageIndex","request","nameFilter","creatioDateFilter","customerStatusFilter","getCustomersOrderByName","ascending","Query","getCustomersOrderByCreationDate","getCustomerById","id","newCustomer","name","updateCustomerStatus","status","addCustomerNote","note","ApiService","newCustomerAdded","Bacon","Bus","newNoteAdded","ApplicationBus","apiService","applicationBus","loadItems","loadItemsOrderedByName","loadItemsOrderedByCreationDate","noOrdering","ascOrdering","items","ko","observableArray","errorMessage","observable","nameOrdering","creationdateOrdering","orderByName","orderByCreationDate","pageindex","done","removeAll","fail","error","onValue","onError","message","init","CustomerListViewModel","canInsertNewItem","computed","insertNewItem","result","push","Error","NewCustomerViewModel","customerId","loadItem","itemLoaded","creationDate","statusList","notes","subscribe","newStatus","item","CustomerViewModel","canInsertNewNote","insertNewNote","NewNoteViewModel","viewModel","customerList","applyBindings","IndexApp","customer","newNote","CustomerApp"],"mappings":"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","file":"site.min.js","sourcesContent":["this.ptt = (function (ptt) {\r\n    ptt.ajax = function (type, url, data, contentType, cors, headers) {\r\n        var options = {\r\n            url: url,\r\n            contentType: contentType || \"application/json\",\r\n            cache: false,\r\n            type: type,\r\n            crossDomain: cors,\r\n            data: data ? JSON.stringify(data) : null\r\n        };\r\n        if (headers) {\r\n            options.headers = headers;\r\n        }\r\n        return jQuery.ajax(options);\r\n    };\r\n    ptt.postJson = function (url, data, cors) {\r\n        return ptt.ajax(\"POST\", url, data, null, cors, null);\r\n    };\r\n    ptt.getJson = function (url, cors) {\r\n        return ptt.ajax(\"GET\", url, null, null, cors, null);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function () {\r\n        var self = this,\r\n            route = \"http://\" + location.host + \"/api/\",\r\n            getCustomersServiceUrl = route + \"GetCustomers\",\r\n            getCustomersOrderByNameServiceUrl = route + \"GetCustomersOrderByName\",\r\n            getCustomersOrderByCreationDateServiceUrl = route + \"GetCustomersOrderByCreationDate\",\r\n            getCustomerByIdServiceUrl = route + \"GetCustomerById\",\r\n            newCustomerServiceUrl = route + \"NewCustomer\",\r\n            updateCustomerStatusServiceUrl = route + \"UpdateCustomerStatus\",\r\n            addCustomerNoteServiceUrl = route + \"AddCustomerNote\";\r\n\r\n        self.getCustomers = function (pageSize, pageIndex) {\r\n            var request = {\r\n                pageSize: pageSize,\r\n                pageIndex: pageIndex,\r\n                nameFilter: null,\r\n                creatioDateFilter: null,\r\n                customerStatusFilter: null\r\n            };\r\n            return ptt.postJson(getCustomersServiceUrl, request, false);\r\n        };\r\n\r\n        self.getCustomersOrderByName = function (pageSize, pageIndex, ascending) {\r\n            var request = {\r\n                Query: {\r\n                    pageSize: pageSize,\r\n                    pageIndex: pageIndex,\r\n                    nameFilter: null,\r\n                    creatioDateFilter: null,\r\n                    customerStatusFilter: null\r\n                },\r\n                ascending: ascending\r\n            };\r\n            return ptt.postJson(getCustomersOrderByNameServiceUrl, request, false);\r\n        };\r\n\r\n        self.getCustomersOrderByCreationDate = function (pageSize, pageIndex, ascending) {\r\n            var request = {\r\n                Query: {\r\n                    pageSize: pageSize,\r\n                    pageIndex: pageIndex,\r\n                    nameFilter: null,\r\n                    creatioDateFilter: null,\r\n                    customerStatusFilter: null\r\n                },\r\n                ascending: ascending\r\n            };\r\n            return ptt.postJson(getCustomersOrderByCreationDateServiceUrl, request, false);\r\n        };\r\n\r\n        self.getCustomerById = function (id) {\r\n            var request = {\r\n                id: id\r\n            };\r\n            return ptt.postJson(getCustomerByIdServiceUrl, request, false);\r\n        };\r\n\r\n        self.newCustomer = function (name) {\r\n            var request = {\r\n                name: name\r\n            };\r\n            return ptt.postJson(newCustomerServiceUrl, request, false);\r\n        };\r\n\r\n        self.updateCustomerStatus = function (id, status) {\r\n            var request = {\r\n                id: id,\r\n                status: status\r\n            };\r\n            return ptt.postJson(updateCustomerStatusServiceUrl, request, false);\r\n        };\r\n\r\n        self.addCustomerNote = function (id, note) {\r\n            var request = {\r\n                id: id,\r\n                note: note\r\n            };\r\n            return ptt.postJson(addCustomerNoteServiceUrl, request, false);\r\n        };\r\n    };\r\n    ptt.ApiService = function () {\r\n        return new ctor();\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function () {\r\n        var self = this;\r\n\r\n        self.newCustomerAdded = new Bacon.Bus();\r\n        self.newNoteAdded = new Bacon.Bus();\r\n    };\r\n    ptt.ApplicationBus = function () {\r\n        return new ctor();\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (apiService, applicationBus) {\r\n        var self = this,\r\n            noOrdering = \"glyphicon-minus\",\r\n            ascOrdering = \"glyphicon-chevron-up\",\r\n            descOrdering = \"glyphicon-chevron-down\",\r\n            loadItems,\r\n            loadItemsOrderedByName,\r\n            loadItemsOrderedByCreationDate;\r\n\r\n        self.items = ko.observableArray([]);\r\n        self.errorMessage = ko.observable(\"\");\r\n        self.nameOrdering = ko.observable(noOrdering);\r\n        self.creationdateOrdering = ko.observable(noOrdering);\r\n\r\n        self.orderByName = function () {\r\n            self.creationdateOrdering(noOrdering);\r\n            if (self.nameOrdering() == ascOrdering) {\r\n                self.nameOrdering(descOrdering);\r\n                loadItemsOrderedByName(10, 0, false);\r\n            } else {\r\n                self.nameOrdering(ascOrdering);\r\n                loadItemsOrderedByName(10, 0, true);\r\n            }\r\n        };\r\n\r\n        self.orderByCreationDate = function () {\r\n            self.nameOrdering(noOrdering);\r\n            if (self.creationdateOrdering() == ascOrdering) {\r\n                self.creationdateOrdering(descOrdering);\r\n                loadItemsOrderedByCreationDate(10, 0, false);\r\n            } else {\r\n                self.creationdateOrdering(ascOrdering);\r\n                loadItemsOrderedByCreationDate(10, 0, true);\r\n            }\r\n        };\r\n\r\n        loadItems = function (pageSize, pageindex) {\r\n            self.nameOrdering(noOrdering);\r\n            self.creationdateOrdering(noOrdering);\r\n            apiService.getCustomers(pageSize, pageindex)\r\n                .done(function (items) {\r\n                    self.errorMessage(\"\");\r\n                    self.items.removeAll();\r\n                    self.items(items);\r\n                })\r\n                .fail(function (error) {\r\n                    self.errorMessage(\"An error has occurred loading customers\");\r\n                });\r\n        };\r\n\r\n        loadItemsOrderedByName = function (pageSize, pageindex, ascending) {\r\n            apiService.getCustomersOrderByName(pageSize, pageindex, ascending)\r\n                .done(function (items) {\r\n                    self.errorMessage(\"\");\r\n                    self.items.removeAll();\r\n                    self.items(items);\r\n                })\r\n                .fail(function (error) {\r\n                    self.errorMessage(\"An error has occurred loading customers\");\r\n                });\r\n        };\r\n\r\n        loadItemsOrderedByCreationDate = function (pageSize, pageindex, ascending) {\r\n            apiService.getCustomersOrderByCreationDate(pageSize, pageindex, ascending)\r\n                .done(function (items) {\r\n                    self.errorMessage(\"\");\r\n                    self.items.removeAll();\r\n                    self.items(items);\r\n                })\r\n                .fail(function (error) {\r\n                    self.errorMessage(\"An error has occurred loading customers\");\r\n                });\r\n        };\r\n\r\n        applicationBus.newCustomerAdded\r\n            .onValue(function () {\r\n                self.errorMessage(\"\");\r\n                loadItems(10, 0);\r\n            });\r\n\r\n        applicationBus.newCustomerAdded\r\n            .onError(function (error) {\r\n                self.errorMessage(error.message);\r\n            });\r\n\r\n        self.init = function () {\r\n            self.errorMessage(\"\");\r\n            self.nameOrdering(noOrdering);\r\n            self.creationdateOrdering(noOrdering);\r\n            loadItems(10, 0);\r\n        };\r\n    };\r\n    ptt.CustomerListViewModel = function (apiService, applicationBus) {\r\n        return new ctor(apiService, applicationBus);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (apiService, applicationBus) {\r\n        var self = this;\r\n\r\n        self.name = ko.observable(\"\");\r\n\r\n        self.canInsertNewItem = ko.computed(function () {\r\n            return self.name() && true;\r\n        }, self);\r\n\r\n        self.insertNewItem = function () {\r\n            apiService.newCustomer(self.name())\r\n                .done(function (result) {\r\n                    self.name(\"\");\r\n                    applicationBus.newCustomerAdded.push(true);\r\n                })\r\n                .fail(function () {\r\n                    applicationBus.newCustomerAdded.error(new Bacon.Error(\"Error inserting a new Customer\"));\r\n                });\r\n        };\r\n    };\r\n    ptt.NewCustomerViewModel = function (apiService, applicationBus) {\r\n        return new ctor(apiService, applicationBus);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (apiService, applicationBus, customerId) {\r\n        var self = this,\r\n            loadItem,\r\n            itemLoaded = false;\r\n\r\n        self.name = ko.observable(\"\");\r\n        self.errorMessage = ko.observable(\"\");\r\n        self.creationDate = ko.observable(\"\");\r\n        self.status = ko.observable(\"\");\r\n        self.statusList = ko.observableArray([\r\n            \"Prospective\",\r\n            \"Current\",\r\n            \"NonActive\"\r\n        ]);\r\n        self.notes = ko.observableArray([]);\r\n\r\n        self.status.subscribe(function (newStatus) {\r\n            if (itemLoaded == true) {\r\n                apiService.updateCustomerStatus(customerId, newStatus)\r\n                    .done(function () {\r\n                        self.errorMessage(\"\");\r\n                    })\r\n                    .fail(function (error) {\r\n                        self.errorMessage(\"An error has occurred updating status\");\r\n                    });\r\n            } else {\r\n                itemLoaded = true;\r\n            }\r\n        });\r\n\r\n        loadItem = function (customerId) {\r\n            apiService.getCustomerById(customerId)\r\n                .done(function (item) {\r\n                    self.errorMessage(\"\");\r\n                    self.name(item.name);\r\n                    self.creationDate(item.creationDate);\r\n                    self.status(item.status);\r\n                    self.notes.removeAll();\r\n                    self.notes(item.notes);\r\n                })\r\n                .fail(function (error) {\r\n                    self.errorMessage(\"An error has occurred loading customer\");\r\n                });\r\n        };\r\n\r\n        applicationBus.newNoteAdded\r\n            .onValue(function () {\r\n                self.errorMessage(\"\");\r\n                itemLoaded = false;\r\n                loadItem(customerId);\r\n            });\r\n\r\n        applicationBus.newNoteAdded\r\n            .onError(function (error) {\r\n                self.errorMessage(error.message);\r\n            });\r\n\r\n        self.init = function () {\r\n            loadItem(customerId);\r\n        };\r\n    };\r\n    ptt.CustomerViewModel = function (apiService, applicationBus, customerId) {\r\n        return new ctor(apiService, applicationBus, customerId);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (apiService, applicationBus, customerId) {\r\n        var self = this;\r\n\r\n        self.note = ko.observable(\"\");\r\n\r\n        self.canInsertNewNote = ko.computed(function () {\r\n            return self.note() && true;\r\n        }, self);\r\n\r\n        self.insertNewNote = function () {\r\n            apiService.addCustomerNote(customerId, self.note())\r\n                .done(function (result) {\r\n                    self.note(\"\");\r\n                    applicationBus.newNoteAdded.push(true);\r\n                })\r\n                .fail(function () {\r\n                    applicationBus.newNoteAdded.error(new Bacon.Error(\"Error inserting a new Note\"));\r\n                });\r\n        };\r\n    };\r\n    ptt.NewNoteViewModel = function (apiService, applicationBus, customerId) {\r\n        return new ctor(apiService, applicationBus, customerId);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function () {\r\n        var apiService = ptt.ApiService(),\r\n            applicationBus = ptt.ApplicationBus(),\r\n            viewModel = {\r\n                customerList: ptt.CustomerListViewModel(apiService, applicationBus),\r\n                newCustomer: ptt.NewCustomerViewModel(apiService, applicationBus)\r\n            };\r\n        ko.applyBindings(viewModel);\r\n        viewModel.customerList.init();\r\n    };\r\n    ptt.IndexApp = function () {\r\n        return new ctor();\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (customerId) {\r\n        var apiService = ptt.ApiService(),\r\n            applicationBus = ptt.ApplicationBus(),\r\n            viewModel = {\r\n                customer: ptt.CustomerViewModel(apiService, applicationBus, customerId),\r\n                newNote: ptt.NewNoteViewModel(apiService, applicationBus, customerId),\r\n            };\r\n        ko.applyBindings(viewModel);\r\n        viewModel.customer.init();\r\n    };\r\n    ptt.CustomerApp = function (customerId) {\r\n        return new ctor(customerId);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));"]}