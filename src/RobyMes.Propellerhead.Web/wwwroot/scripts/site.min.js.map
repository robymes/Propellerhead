{"version":3,"sources":["Utils.js","ApiService.js","ApplicationBus.js","CustomerListViewModel.js","NewCustomerViewModel.js","CustomerViewModel.js","IndexApp.js","CustomerApp.js"],"names":["this","ptt","ajax","type","url","data","contentType","cors","headers","options","cache","crossDomain","JSON","stringify","jQuery","postJson","getJson","ctor","self","route","location","host","getCustomersServiceUrl","getCustomersOrderByNameServiceUrl","getCustomersOrderByCreationDateServiceUrl","getCustomerByIdServiceUrl","newCustomerServiceUrl","getCustomers","pageSize","pageIndex","request","PageSize","PageIndex","NameFilter","CreatioDateFilter","CustomerStatusFilter","getCustomersOrderByName","ascending","Query","Ascending","getCustomersOrderByCreationDate","getCustomerById","id","Id","newCustomer","name","Name","ApiService","newCustomerAdded","Bacon","Bus","ApplicationBus","apiService","applicationBus","loadItems","loadItemsOrderedByName","loadItemsOrderedByCreationDate","noOrdering","ascOrdering","items","ko","observableArray","errorMessage","observable","nameOrdering","creationdateOrdering","orderByName","orderByCreationDate","pageindex","done","removeAll","fail","error","onValue","onError","message","init","CustomerListViewModel","canInsertNewItem","computed","insertNewItem","result","push","Error","NewCustomerViewModel","customerId","loadItem","creationDate","item","CustomerViewModel","viewModel","customerList","applyBindings","IndexApp","customer","CustomerApp"],"mappings":"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","file":"site.min.js","sourcesContent":["this.ptt = (function (ptt) {\r\n    ptt.ajax = function (type, url, data, contentType, cors, headers) {\r\n        var options = {\r\n            url: url,\r\n            contentType: contentType || \"application/json\",\r\n            cache: false,\r\n            type: type,\r\n            crossDomain: cors,\r\n            data: data ? JSON.stringify(data) : null\r\n        };\r\n        if (headers) {\r\n            options.headers = headers;\r\n        }\r\n        return jQuery.ajax(options);\r\n    };\r\n    ptt.postJson = function (url, data, cors) {\r\n        return ptt.ajax(\"POST\", url, data, null, cors, null);\r\n    };\r\n    ptt.getJson = function (url, cors) {\r\n        return ptt.ajax(\"GET\", url, null, null, cors, null);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function () {\r\n        var self = this,\r\n            route = \"http://\" + location.host + \"/api/\",\r\n            getCustomersServiceUrl = route + \"GetCustomers\",\r\n            getCustomersOrderByNameServiceUrl = route + \"GetCustomersOrderByName\",\r\n            getCustomersOrderByCreationDateServiceUrl = route + \"GetCustomersOrderByCreationDate\",\r\n            getCustomerByIdServiceUrl = route + \"GetCustomerById\",\r\n            newCustomerServiceUrl = route + \"NewCustomer\";\r\n\r\n        self.getCustomers = function (pageSize, pageIndex) {\r\n            var request = {\r\n                PageSize: pageSize,\r\n                PageIndex: pageIndex,\r\n                NameFilter: null,\r\n                CreatioDateFilter: null,\r\n                CustomerStatusFilter: null\r\n            };\r\n            return ptt.postJson(getCustomersServiceUrl, request, false);\r\n        };\r\n\r\n        self.getCustomersOrderByName = function (pageSize, pageIndex, ascending) {\r\n            var request = {\r\n                Query: {\r\n                    PageSize: pageSize,\r\n                    PageIndex: pageIndex,\r\n                    NameFilter: null,\r\n                    CreatioDateFilter: null,\r\n                    CustomerStatusFilter: null\r\n                },\r\n                Ascending: ascending\r\n            };\r\n            return ptt.postJson(getCustomersOrderByNameServiceUrl, request, false);\r\n        };\r\n\r\n        self.getCustomersOrderByCreationDate = function (pageSize, pageIndex, ascending) {\r\n            var request = {\r\n                Query: {\r\n                    PageSize: pageSize,\r\n                    PageIndex: pageIndex,\r\n                    NameFilter: null,\r\n                    CreatioDateFilter: null,\r\n                    CustomerStatusFilter: null\r\n                },\r\n                Ascending: ascending\r\n            };\r\n            return ptt.postJson(getCustomersOrderByCreationDateServiceUrl, request, false);\r\n        };\r\n\r\n        self.getCustomerById = function (id) {\r\n            var request = {\r\n                Id: id\r\n            };\r\n            return ptt.postJson(getCustomerByIdServiceUrl, request, false);\r\n        };\r\n\r\n        self.newCustomer = function (name) {\r\n            var request = {\r\n                Name: name\r\n            };\r\n            return ptt.postJson(newCustomerServiceUrl, request, false);\r\n        };\r\n    };\r\n    ptt.ApiService = function () {\r\n        return new ctor();\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function () {\r\n        var self = this;\r\n\r\n        self.newCustomerAdded = new Bacon.Bus();\r\n    };\r\n    ptt.ApplicationBus = function () {\r\n        return new ctor();\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (apiService, applicationBus) {\r\n        var self = this,\r\n            noOrdering = \"glyphicon-minus\",\r\n            ascOrdering = \"glyphicon-chevron-up\",\r\n            descOrdering = \"glyphicon-chevron-down\",\r\n            loadItems,\r\n            loadItemsOrderedByName,\r\n            loadItemsOrderedByCreationDate;\r\n\r\n        self.items = ko.observableArray([]);\r\n        self.errorMessage = ko.observable(\"\");\r\n        self.nameOrdering = ko.observable(noOrdering);\r\n        self.creationdateOrdering = ko.observable(noOrdering);\r\n\r\n        self.orderByName = function () {\r\n            self.creationdateOrdering(noOrdering);\r\n            if (self.nameOrdering() == ascOrdering) {\r\n                self.nameOrdering(descOrdering);\r\n                loadItemsOrderedByName(10, 0, false);\r\n            } else {\r\n                self.nameOrdering(ascOrdering);\r\n                loadItemsOrderedByName(10, 0, true);\r\n            }\r\n        };\r\n\r\n        self.orderByCreationDate = function () {\r\n            self.nameOrdering(noOrdering);\r\n            if (self.creationdateOrdering() == ascOrdering) {\r\n                self.creationdateOrdering(descOrdering);\r\n                loadItemsOrderedByCreationDate(10, 0, false);\r\n            } else {\r\n                self.creationdateOrdering(ascOrdering);\r\n                loadItemsOrderedByCreationDate(10, 0, true);\r\n            }\r\n        };\r\n\r\n        loadItems = function (pageSize, pageindex) {\r\n            self.nameOrdering(noOrdering);\r\n            self.creationdateOrdering(noOrdering);\r\n            apiService.getCustomers(pageSize, pageindex)\r\n                .done(function (items) {\r\n                    self.items.removeAll();\r\n                    self.items(items);\r\n                })\r\n                .fail(function (error) {\r\n                    self.errorMessage(\"An error has occurred loading customers\");\r\n                });\r\n        };\r\n\r\n        loadItemsOrderedByName = function (pageSize, pageindex, ascending) {\r\n            apiService.getCustomersOrderByName(pageSize, pageindex, ascending)\r\n                .done(function (items) {\r\n                    self.items.removeAll();\r\n                    self.items(items);\r\n                })\r\n                .fail(function (error) {\r\n                    self.errorMessage(\"An error has occurred loading customers\");\r\n                });\r\n        };\r\n\r\n        loadItemsOrderedByCreationDate = function (pageSize, pageindex, ascending) {\r\n            apiService.getCustomersOrderByCreationDate(pageSize, pageindex, ascending)\r\n                .done(function (items) {\r\n                    self.items.removeAll();\r\n                    self.items(items);\r\n                })\r\n                .fail(function (error) {\r\n                    self.errorMessage(\"An error has occurred loading customers\");\r\n                });\r\n        };\r\n\r\n        applicationBus.newCustomerAdded\r\n            .onValue(function () {\r\n                loadItems(10, 0);\r\n            });\r\n\r\n        applicationBus.newCustomerAdded\r\n            .onError(function (error) {\r\n                self.errorMessage(error.message);\r\n            });\r\n\r\n        self.init = function () {\r\n            self.errorMessage(\"\");\r\n            self.nameOrdering(noOrdering);\r\n            self.creationdateOrdering(noOrdering);\r\n            loadItems(10, 0);\r\n        };\r\n    };\r\n    ptt.CustomerListViewModel = function (apiService, applicationBus) {\r\n        return new ctor(apiService, applicationBus);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (apiService, applicationBus) {\r\n        var self = this;\r\n\r\n        self.name = ko.observable(\"\");\r\n\r\n        self.canInsertNewItem = ko.computed(function () {\r\n            return self.name() && true;\r\n        }, self);\r\n\r\n        self.insertNewItem = function () {\r\n            apiService.newCustomer(self.name())\r\n                .done(function (result) {\r\n                    self.name(\"\");\r\n                    applicationBus.newCustomerAdded.push(true);\r\n                })\r\n                .fail(function () {\r\n                    applicationBus.newCustomerAdded.error(new Bacon.Error(\"Error inserting a new Customer\"));\r\n                });\r\n        };\r\n    };\r\n    ptt.NewCustomerViewModel = function (apiService, applicationBus) {\r\n        return new ctor(apiService, applicationBus);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (apiService, applicationBus, customerId) {\r\n        var self = this,\r\n            loadItem;\r\n\r\n        self.name = ko.observable(\"\");\r\n        self.errorMessage = ko.observable(\"\");\r\n        self.creationDate = ko.observable(\"\");\r\n\r\n        loadItem = function (customerId) {\r\n            apiService.getCustomerById(customerId)\r\n                .done(function (item) {\r\n                    self.name(item.name);\r\n                    self.creationDate(item.creationDate);\r\n                })\r\n                .fail(function (error) {\r\n                    self.errorMessage(\"An error has occurred loading customers\");\r\n                });\r\n        };\r\n\r\n        self.init = function () {\r\n            loadItem(customerId);\r\n        };\r\n    };\r\n    ptt.CustomerViewModel = function (apiService, applicationBus, customerId) {\r\n        return new ctor(apiService, applicationBus, customerId);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function () {\r\n        var apiService = ptt.ApiService(),\r\n            applicationBus = ptt.ApplicationBus(),\r\n            viewModel = {\r\n                customerList: ptt.CustomerListViewModel(apiService, applicationBus),\r\n                newCustomer: ptt.NewCustomerViewModel(apiService, applicationBus)\r\n            };\r\n        ko.applyBindings(viewModel);\r\n        viewModel.customerList.init();\r\n    };\r\n    ptt.IndexApp = function () {\r\n        return new ctor();\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (customerId) {\r\n        var apiService = ptt.ApiService(),\r\n            applicationBus = ptt.ApplicationBus(),\r\n            viewModel = {\r\n                customer: ptt.CustomerViewModel(apiService, applicationBus, customerId)\r\n            };\r\n        ko.applyBindings(viewModel);\r\n        viewModel.customer.init();\r\n    };\r\n    ptt.CustomerApp = function (customerId) {\r\n        return new ctor(customerId);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));"]}