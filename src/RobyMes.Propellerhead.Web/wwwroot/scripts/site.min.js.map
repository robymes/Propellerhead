{"version":3,"sources":["Utils.js","ApiService.js","ApplicationBus.js","CustomerListViewModel.js","NewCustomerViewModel.js","CustomerViewModel.js","NewNoteViewModel.js","IndexApp.js","CustomerApp.js"],"names":["this","ptt","ajax","type","url","data","contentType","cors","headers","options","cache","crossDomain","JSON","stringify","jQuery","postJson","getJson","ctor","self","route","location","host","getCustomersServiceUrl","getCustomersOrderByNameServiceUrl","getCustomersOrderByCreationDateServiceUrl","getCustomerByIdServiceUrl","newCustomerServiceUrl","updateCustomerStatusServiceUrl","addCustomerNoteServiceUrl","getCustomers","pageSize","pageIndex","statusFilter","request","nameFilter","creatioDateFilter","customerStatusFilter","getCustomersOrderByName","ascending","Query","getCustomersOrderByCreationDate","getCustomerById","id","newCustomer","name","updateCustomerStatus","status","addCustomerNote","note","ApiService","newCustomerAdded","Bacon","Bus","newNoteAdded","ApplicationBus","apiService","applicationBus","loadItems","loadItemsOrderedByName","loadItemsOrderedByCreationDate","noOrdering","ascOrdering","descOrdering","items","ko","observableArray","errorMessage","observable","nameOrdering","creationdateOrdering","statusFilters","subscribe","filter","orderByName","orderByCreationDate","pageindex","done","removeAll","fail","error","onValue","onError","message","init","CustomerListViewModel","canInsertNewItem","computed","insertNewItem","result","push","Error","NewCustomerViewModel","customerId","loadItem","itemLoaded","creationDate","statusList","notes","newStatus","item","CustomerViewModel","canInsertNewNote","insertNewNote","NewNoteViewModel","viewModel","customerList","applyBindings","IndexApp","customer","newNote","CustomerApp"],"mappings":"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","file":"site.min.js","sourcesContent":["this.ptt = (function (ptt) {\r\n    ptt.ajax = function (type, url, data, contentType, cors, headers) {\r\n        var options = {\r\n            url: url,\r\n            contentType: contentType || \"application/json\",\r\n            cache: false,\r\n            type: type,\r\n            crossDomain: cors,\r\n            data: data ? JSON.stringify(data) : null\r\n        };\r\n        if (headers) {\r\n            options.headers = headers;\r\n        }\r\n        return jQuery.ajax(options);\r\n    };\r\n    ptt.postJson = function (url, data, cors) {\r\n        return ptt.ajax(\"POST\", url, data, null, cors, null);\r\n    };\r\n    ptt.getJson = function (url, cors) {\r\n        return ptt.ajax(\"GET\", url, null, null, cors, null);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function () {\r\n        var self = this,\r\n            route = \"http://\" + location.host + \"/api/\",\r\n            getCustomersServiceUrl = route + \"GetCustomers\",\r\n            getCustomersOrderByNameServiceUrl = route + \"GetCustomersOrderByName\",\r\n            getCustomersOrderByCreationDateServiceUrl = route + \"GetCustomersOrderByCreationDate\",\r\n            getCustomerByIdServiceUrl = route + \"GetCustomerById\",\r\n            newCustomerServiceUrl = route + \"NewCustomer\",\r\n            updateCustomerStatusServiceUrl = route + \"UpdateCustomerStatus\",\r\n            addCustomerNoteServiceUrl = route + \"AddCustomerNote\";\r\n\r\n        self.getCustomers = function (pageSize, pageIndex, statusFilter) {\r\n            var request = {\r\n                pageSize: pageSize,\r\n                pageIndex: pageIndex,\r\n                nameFilter: null,\r\n                creatioDateFilter: null,\r\n                customerStatusFilter: statusFilter\r\n            };\r\n            return ptt.postJson(getCustomersServiceUrl, request, false);\r\n        };\r\n\r\n        self.getCustomersOrderByName = function (pageSize, pageIndex, ascending, statusFilter) {\r\n            var request = {\r\n                Query: {\r\n                    pageSize: pageSize,\r\n                    pageIndex: pageIndex,\r\n                    nameFilter: null,\r\n                    creatioDateFilter: null,\r\n                    customerStatusFilter: statusFilter\r\n                },\r\n                ascending: ascending\r\n            };\r\n            return ptt.postJson(getCustomersOrderByNameServiceUrl, request, false);\r\n        };\r\n\r\n        self.getCustomersOrderByCreationDate = function (pageSize, pageIndex, ascending, statusFilter) {\r\n            var request = {\r\n                Query: {\r\n                    pageSize: pageSize,\r\n                    pageIndex: pageIndex,\r\n                    nameFilter: null,\r\n                    creatioDateFilter: null,\r\n                    customerStatusFilter: statusFilter\r\n                },\r\n                ascending: ascending\r\n            };\r\n            return ptt.postJson(getCustomersOrderByCreationDateServiceUrl, request, false);\r\n        };\r\n\r\n        self.getCustomerById = function (id) {\r\n            var request = {\r\n                id: id\r\n            };\r\n            return ptt.postJson(getCustomerByIdServiceUrl, request, false);\r\n        };\r\n\r\n        self.newCustomer = function (name) {\r\n            var request = {\r\n                name: name\r\n            };\r\n            return ptt.postJson(newCustomerServiceUrl, request, false);\r\n        };\r\n\r\n        self.updateCustomerStatus = function (id, status) {\r\n            var request = {\r\n                id: id,\r\n                status: status\r\n            };\r\n            return ptt.postJson(updateCustomerStatusServiceUrl, request, false);\r\n        };\r\n\r\n        self.addCustomerNote = function (id, note) {\r\n            var request = {\r\n                id: id,\r\n                note: note\r\n            };\r\n            return ptt.postJson(addCustomerNoteServiceUrl, request, false);\r\n        };\r\n    };\r\n    ptt.ApiService = function () {\r\n        return new ctor();\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function () {\r\n        var self = this;\r\n\r\n        self.newCustomerAdded = new Bacon.Bus();\r\n        self.newNoteAdded = new Bacon.Bus();\r\n    };\r\n    ptt.ApplicationBus = function () {\r\n        return new ctor();\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (apiService, applicationBus) {\r\n        var self = this,\r\n            noOrdering = \"glyphicon-minus\",\r\n            ascOrdering = \"glyphicon-chevron-up\",\r\n            descOrdering = \"glyphicon-chevron-down\",\r\n            loadItems,\r\n            loadItemsOrderedByName,\r\n            loadItemsOrderedByCreationDate,\r\n            defaultPageSize = 25;\r\n\r\n        self.items = ko.observableArray([]);\r\n        self.errorMessage = ko.observable(\"\");\r\n        self.nameOrdering = ko.observable(noOrdering);\r\n        self.creationdateOrdering = ko.observable(noOrdering);\r\n        self.statusFilters = ko.observableArray([\r\n            \"Prospective\",\r\n            \"Current\",\r\n            \"NonActive\"\r\n        ]);\r\n        self.statusFilter = ko.observable();\r\n\r\n        self.statusFilter.subscribe(function (filter) {\r\n            if (self.nameOrdering() === ascOrdering) {\r\n                loadItemsOrderedByName(defaultPageSize, 0, true);\r\n            } else if (self.nameOrdering() === descOrdering) {\r\n                loadItemsOrderedByName(defaultPageSize, 0, false);\r\n            } else if (self.creationdateOrdering() === ascOrdering) {\r\n                loadItemsOrderedByCreationDate(defaultPageSize, 0, true);\r\n            } else if (self.creationdateOrdering() === descOrdering) {\r\n                loadItemsOrderedByCreationDate(defaultPageSize, 0, false);\r\n            } else {\r\n                loadItems(defaultPageSize, 0);\r\n            }\r\n        });\r\n\r\n        self.orderByName = function () {\r\n            self.creationdateOrdering(noOrdering);\r\n            if (self.nameOrdering() === ascOrdering) {\r\n                self.nameOrdering(descOrdering);\r\n                loadItemsOrderedByName(defaultPageSize, 0, false);\r\n            } else {\r\n                self.nameOrdering(ascOrdering);\r\n                loadItemsOrderedByName(defaultPageSize, 0, true);\r\n            }\r\n        };\r\n\r\n        self.orderByCreationDate = function () {\r\n            self.nameOrdering(noOrdering);\r\n            if (self.creationdateOrdering() === ascOrdering) {\r\n                self.creationdateOrdering(descOrdering);\r\n                loadItemsOrderedByCreationDate(defaultPageSize, 0, false);\r\n            } else {\r\n                self.creationdateOrdering(ascOrdering);\r\n                loadItemsOrderedByCreationDate(defaultPageSize, 0, true);\r\n            }\r\n        };\r\n\r\n        loadItems = function (pageSize, pageindex) {\r\n            self.nameOrdering(noOrdering);\r\n            self.creationdateOrdering(noOrdering);\r\n            apiService.getCustomers(pageSize, pageindex, self.statusFilter())\r\n                .done(function (items) {\r\n                    self.errorMessage(\"\");\r\n                    self.items.removeAll();\r\n                    self.items(items);\r\n                })\r\n                .fail(function (error) {\r\n                    self.errorMessage(\"An error has occurred loading customers\");\r\n                });\r\n        };\r\n\r\n        loadItemsOrderedByName = function (pageSize, pageindex, ascending) {\r\n            apiService.getCustomersOrderByName(pageSize, pageindex, ascending, self.statusFilter())\r\n                .done(function (items) {\r\n                    self.errorMessage(\"\");\r\n                    self.items.removeAll();\r\n                    self.items(items);\r\n                })\r\n                .fail(function (error) {\r\n                    self.errorMessage(\"An error has occurred loading customers\");\r\n                });\r\n        };\r\n\r\n        loadItemsOrderedByCreationDate = function (pageSize, pageindex, ascending) {\r\n            apiService.getCustomersOrderByCreationDate(pageSize, pageindex, ascending, self.statusFilter())\r\n                .done(function (items) {\r\n                    self.errorMessage(\"\");\r\n                    self.items.removeAll();\r\n                    self.items(items);\r\n                })\r\n                .fail(function (error) {\r\n                    self.errorMessage(\"An error has occurred loading customers\");\r\n                });\r\n        };\r\n\r\n        applicationBus.newCustomerAdded\r\n            .onValue(function () {\r\n                self.errorMessage(\"\");\r\n                loadItems(defaultPageSize, 0);\r\n            });\r\n\r\n        applicationBus.newCustomerAdded\r\n            .onError(function (error) {\r\n                self.errorMessage(error.message);\r\n            });\r\n\r\n        self.init = function () {\r\n            self.errorMessage(\"\");\r\n            self.nameOrdering(noOrdering);\r\n            self.creationdateOrdering(noOrdering);\r\n            loadItems(defaultPageSize, 0);\r\n        };\r\n    };\r\n    ptt.CustomerListViewModel = function (apiService, applicationBus) {\r\n        return new ctor(apiService, applicationBus);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (apiService, applicationBus) {\r\n        var self = this;\r\n\r\n        self.name = ko.observable(\"\");\r\n\r\n        self.canInsertNewItem = ko.computed(function () {\r\n            return self.name() && true;\r\n        }, self);\r\n\r\n        self.insertNewItem = function () {\r\n            apiService.newCustomer(self.name())\r\n                .done(function (result) {\r\n                    self.name(\"\");\r\n                    applicationBus.newCustomerAdded.push(true);\r\n                })\r\n                .fail(function () {\r\n                    applicationBus.newCustomerAdded.error(new Bacon.Error(\"Error inserting a new Customer\"));\r\n                });\r\n        };\r\n    };\r\n    ptt.NewCustomerViewModel = function (apiService, applicationBus) {\r\n        return new ctor(apiService, applicationBus);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (apiService, applicationBus, customerId) {\r\n        var self = this,\r\n            loadItem,\r\n            itemLoaded = false;\r\n\r\n        self.name = ko.observable(\"\");\r\n        self.errorMessage = ko.observable(\"\");\r\n        self.creationDate = ko.observable(\"\");\r\n        self.status = ko.observable(\"\");\r\n        self.statusList = ko.observableArray([\r\n            \"Prospective\",\r\n            \"Current\",\r\n            \"NonActive\"\r\n        ]);\r\n        self.notes = ko.observableArray([]);\r\n\r\n        self.status.subscribe(function (newStatus) {\r\n            if (itemLoaded == true) {\r\n                apiService.updateCustomerStatus(customerId, newStatus)\r\n                    .done(function () {\r\n                        self.errorMessage(\"\");\r\n                    })\r\n                    .fail(function (error) {\r\n                        self.errorMessage(\"An error has occurred updating status\");\r\n                    });\r\n            } else {\r\n                itemLoaded = true;\r\n            }\r\n        });\r\n\r\n        loadItem = function (customerId) {\r\n            apiService.getCustomerById(customerId)\r\n                .done(function (item) {\r\n                    self.errorMessage(\"\");\r\n                    self.name(item.name);\r\n                    self.creationDate(item.creationDate);\r\n                    self.status(item.status);\r\n                    self.notes.removeAll();\r\n                    self.notes(item.notes);\r\n                })\r\n                .fail(function (error) {\r\n                    self.errorMessage(\"An error has occurred loading customer\");\r\n                });\r\n        };\r\n\r\n        applicationBus.newNoteAdded\r\n            .onValue(function () {\r\n                self.errorMessage(\"\");\r\n                itemLoaded = false;\r\n                loadItem(customerId);\r\n            });\r\n\r\n        applicationBus.newNoteAdded\r\n            .onError(function (error) {\r\n                self.errorMessage(error.message);\r\n            });\r\n\r\n        self.init = function () {\r\n            loadItem(customerId);\r\n        };\r\n    };\r\n    ptt.CustomerViewModel = function (apiService, applicationBus, customerId) {\r\n        return new ctor(apiService, applicationBus, customerId);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (apiService, applicationBus, customerId) {\r\n        var self = this;\r\n\r\n        self.note = ko.observable(\"\");\r\n\r\n        self.canInsertNewNote = ko.computed(function () {\r\n            return self.note() && true;\r\n        }, self);\r\n\r\n        self.insertNewNote = function () {\r\n            apiService.addCustomerNote(customerId, self.note())\r\n                .done(function (result) {\r\n                    self.note(\"\");\r\n                    applicationBus.newNoteAdded.push(true);\r\n                })\r\n                .fail(function () {\r\n                    applicationBus.newNoteAdded.error(new Bacon.Error(\"Error inserting a new Note\"));\r\n                });\r\n        };\r\n    };\r\n    ptt.NewNoteViewModel = function (apiService, applicationBus, customerId) {\r\n        return new ctor(apiService, applicationBus, customerId);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function () {\r\n        var apiService = ptt.ApiService(),\r\n            applicationBus = ptt.ApplicationBus(),\r\n            viewModel = {\r\n                customerList: ptt.CustomerListViewModel(apiService, applicationBus),\r\n                newCustomer: ptt.NewCustomerViewModel(apiService, applicationBus)\r\n            };\r\n        ko.applyBindings(viewModel);\r\n        viewModel.customerList.init();\r\n    };\r\n    ptt.IndexApp = function () {\r\n        return new ctor();\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));","this.ptt = (function (ptt) {\r\n    var ctor = function (customerId) {\r\n        var apiService = ptt.ApiService(),\r\n            applicationBus = ptt.ApplicationBus(),\r\n            viewModel = {\r\n                customer: ptt.CustomerViewModel(apiService, applicationBus, customerId),\r\n                newNote: ptt.NewNoteViewModel(apiService, applicationBus, customerId),\r\n            };\r\n        ko.applyBindings(viewModel);\r\n        viewModel.customer.init();\r\n    };\r\n    ptt.CustomerApp = function (customerId) {\r\n        return new ctor(customerId);\r\n    };\r\n    return ptt;\r\n}(this.ptt || {}));"]}